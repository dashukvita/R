# 1. –ù–∞–ø–∏—à–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é smart_test, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ dataframe —Å –¥–≤—É–º—è –Ω–æ–º–∏–Ω–∞—Ç–∏–≤–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º –≥—Ä–∞–¥–∞—Ü–∏–π. –§—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≥–∏–ø–æ—Ç–µ–∑—É –æ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —ç—Ç–∏—Ö –¥–≤—É—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∫—Ä–∏—Ç–µ—Ä–∏—è —Ö–∏ - –∫–≤–∞–¥—Ä–∞—Ç –∏–ª–∏ —Ç–æ—á–Ω–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä–∏—è –§–∏—à–µ—Ä–∞.
smart_test <-  function(x){
  x <- table(x)
  if (min(x) < 5) {
    result_list <- fisher.test(x)
    result_vec <- c(result_list$p.value)
  }
  else {
    result_list <- chisq.test(x)
    result_vec <- c(result_list$statistic[[1]], result_list$parameter[[1]], result_list$p.value[[1]])
  }
  result_vec
}

#2 –ù–∞–ø–∏—à–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é most_significant, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ dataframe —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –≥–¥–µ –∫–∞–∂–¥–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —ç—Ç–æ –Ω—É–∫–ª–µ–æ—Ç–∏–¥–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å. 
#–§—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –≤–µ–∫—Ç–æ—Ä —Å ˇ–Ω–∞–∑–≤–∞–Ω–∏–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (–∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö), –≤ –∫–æ—Ç–æ—Ä–æ–π –±—ã–ª –ø–æ–ª—É—á–µ–Ω –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π p - —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –≥–∏–ø–æ—Ç–µ–∑—ã –æ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –Ω—É–∫–ª–µ–æ—Ç–∏–¥–æ–≤ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∫—Ä–∏—Ç–µ—Ä–∏—è —Ö–∏ - –∫–≤–∞–¥—Ä–∞—Ç. 
most_significant <-  function(x){
  n <- ncol(x)
  mat_r <- matrix(,nrow = 1, ncol=ncol(x))
  colnames(mat_r) <- colnames(x)
  for(i in 1:n){
    mat_r[1, i] <- chisq.test(table(test_data[i]))$p.value
  }
  names(which(mat_r[1,] == min(mat_r)))
}